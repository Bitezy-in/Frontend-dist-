import{r as u,x as M,j as e,c as j,y as O,u as P,d as Y,e as f,a as I,z as _,A as W,B as G,C as K,b as Q,o as H,n as Z,p as U,q as J,D as X,E as ee,L as se}from"./index-CGAI1unE.js";import{A as te,C as re}from"./Container-CJ2ajp-G.js";import{G as N}from"./iconBase-C-KAd6xH.js";import{C as T,a as E}from"./card-Dr-nCX_D.js";import{c as oe,D as ae,a as ne,b as le,d as ie,e as ce,f as de,g as me}from"./dialog-4lUn71p0.js";import{F as ue}from"./index-DXpTgGh4.js";import{a as xe,b as ge,c as he}from"./index-Ckg-kY5e.js";import{u as pe,D as fe}from"./esm-3IqLee9b.js";import{S as je,c as ye}from"./utils-F_wR6dLb.js";import{c as ve}from"./index-Bb4qSo10.js";function be(t){return N({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 277.333H277.333V416h-42.666V277.333H96v-42.666h138.667V96h42.666v138.667H416v42.666z"},child:[]}]})(t)}function we(t){return N({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M96 235h320v42H96z"},child:[]}]})(t)}/**
 * @license lucide-react v0.438.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=oe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ne=({onChangeCords:t})=>{const a=u.useRef(null),[s,n]=u.useState(null),[c,r]=u.useState(null),i={lat:13.5631658,lng:80.0199452},h=()=>({path:`M 12,0 C 5.364,0 0,5.364 0,12 c 0,7.732 12,24 12,24 0,0 12,-16.268 12,-24 
            C 24,5.364 18.636,0 12,0 Z 
            M 12,16 c -2.209,0 -4,-1.791 -4,-4 0,-2.209 1.791,-4 4,-4 2.209,0 4,1.791 4,4 
            0,2.209 -1.791,4 -4,4 z`,fillColor:"#FF3B30",fillOpacity:1,strokeWeight:2,strokeColor:"#FFFFFF",scale:1.5,anchor:new window.google.maps.Point(12,36),labelOrigin:new window.google.maps.Point(12,-20)});return u.useEffect(()=>{const p=`
      .custom-marker-label {
        background-color: white !important;
        padding: 6px 10px !important;
        border-radius: 10px !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2) !important;
        border: 2px solid #FF3B30 !important;
        font-family: Arial, sans-serif !important;
        font-size: 13px !important;
        font-weight: bold !important;
        color: #FF3B30 !important;
        white-space: pre-line !important;
        text-align: center !important;
        line-height: 1.4 !important;
        max-width: 300px !important;
      }
    `,x=document.createElement("style");x.textContent=p,document.head.appendChild(x);const b=()=>{if(window.google){y();return}const l=document.createElement("script");l.src=`https://maps.googleapis.com/maps/api/js?key=${M}`,l.async=!0,l.defer=!0,l.onload=y,l.onerror=()=>n("Failed to load Google Maps"),document.head.appendChild(l)},y=()=>{if(!a.current)return;const l=new window.google.maps.Map(a.current,{center:i,zoom:16,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1,zoomControlOptions:{position:window.google.maps.ControlPosition.RIGHT_CENTER}});setTimeout(()=>{window.google.maps.event.trigger(l,"resize")},100),navigator.geolocation?navigator.geolocation.getCurrentPosition(d=>{const m={lat:d.coords.latitude,lng:d.coords.longitude};l.setCenter(m),r(m),t(d.coords.latitude,d.coords.longitude);const F=new window.google.maps.Marker({position:m,map:l,label:{text:`Your order will be delivered here.
Move pin to your exact location.`,className:"custom-marker-label"},icon:h(),animation:window.google.maps.Animation.DROP}),k=new window.google.maps.Circle({strokeColor:"#FF3B30",strokeOpacity:.8,strokeWeight:1,fillColor:"#FF3B30",fillOpacity:.3,map:l,center:m,radius:30,animation:window.google.maps.Animation.DROP});l.addListener("center_changed",()=>{const v=l.getCenter();F.setPosition(v),k.setCenter(v)}),l.addListener("idle",()=>{const v=l.getCenter(),w={lat:v.lat(),lng:v.lng()};r(w),t(w.lat,w.lng)})},()=>{n("Error: The Geolocation service failed.")}):n("Error: Your browser doesn't support geolocation.")};return b(),()=>{const l=document.querySelector('script[src*="maps.googleapis.com/maps/api/js"]');l&&l.remove(),x&&x.remove()}},[M]),e.jsxs("div",{className:"relative w-full aspect-square max-h-[50vh] bg-white rounded-lg shadow-lg",children:[s&&e.jsx(T,{className:"absolute top-2 left-2 z-10",children:e.jsx(E,{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[e.jsx(Ce,{size:16}),e.jsx("p",{className:"text-sm",children:s})]})})}),c&&e.jsx(T,{className:"absolute top-2 right-2 z-10 bg-white/90 backdrop-blur shadow-lg",children:e.jsx(E,{className:"p-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:"Current Location"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("p",{children:["Latitude: ",c.lat.toFixed(6)]}),e.jsxs("p",{children:["Longitude: ",c.lng.toFixed(6)]})]})]})})}),e.jsx("div",{ref:a,className:"w-full h-full rounded-lg overflow-hidden","data-testid":"google-map"})]})},Fe=({address:t,handleChange:a,handleClick:s})=>e.jsx("div",{id:"address-form",className:"p-4 border-t transition-all duration-300 ease-in-out",children:e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Address Line1"}),e.jsx("input",{type:"text",id:"fullName",name:"addressLine1",value:t.addressLine1,onChange:a,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"streetAddress",className:"block text-sm font-medium text-gray-700",children:"Address Line2"}),e.jsx("input",{type:"text",id:"streetAddress",name:"addressLine2",value:t.addressLine2,onChange:a,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",id:"city",name:"city",value:t.city,onChange:a,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsx("input",{type:"text",id:"state",name:"state",value:t.state,onChange:a,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"zipCode",className:"block text-sm font-medium text-gray-700",children:"Zip Code"}),e.jsx("input",{type:"text",id:"zipCode",name:"zipCode",value:t.zipCode,onChange:a,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:"Country"}),e.jsx("input",{type:"text",id:"country",name:"country",value:t.country,onChange:a,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:outline-none focus:ring-1 focus:ring-gray-400"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 focus:outline-none focus:ring-2",children:"Save Address"})})]})}),ke=()=>{const t=j(O),a=P(),s=Y(),[n,c]=u.useState(!1),[r,i]=u.useState({addressLine1:"",addressLine2:"",city:"",state:"",zipCode:"",country:"",latitude:0,longitude:0}),[h,p]=u.useState(!1),x=()=>{if(!t){f.error("Please login first!!"),s("/login");return}c(!n)},b=(d,m)=>{i({...r,latitude:d,longitude:m})},y=d=>{i({...r,[d.target.name]:d.target.value})},l=async d=>{if(d.preventDefault(),!t){f.error("Please login first!!"),s("/login");return}try{const{data:m}=await I.post("/add-address",{...r},{withCredentials:!0});m.success&&(a(_(r)),a(W(r)),i({addressLine1:"",addressLine2:"",city:"",state:"",zipCode:"",country:"",latitude:0,longitude:0}),c(!1),f.success(m.message))}catch(m){console.error(m.message)}};return e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("button",{className:"w-full flex justify-between items-center p-4 text-left text-gray-700 focus:outline-none",onClick:x,"aria-expanded":n,"aria-controls":"address-form",children:[e.jsx("span",{className:"text-lg font-medium",children:"Add Delivery Address"}),n?e.jsx(we,{}):e.jsx(be,{})]}),n&&(h?e.jsx(Fe,{address:r,handleChange:y,handleClick:l}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{onChangeCords:b}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"bg-orange-500 py-2 px-4 rounded-md text-white m-2",onClick:()=>p(!0),children:"Confirm Location"})})]}))]})};function Ae(t){return N({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(t)}const De=()=>{const t=j(O),a=j(G),s=P(),n=r=>{s(_(r))},c=async r=>{try{const{data:i}=await I.delete(`/delete-address/${r}`);i.success&&(f.success(i.message),s(K(r)))}catch(i){f.error(i.response.data.message)}};return e.jsx("div",{className:"space-y-4 bg-white my-4 p-4 rounded-md",children:t==null?void 0:t.addresses.map((r,i)=>e.jsxs("div",{className:`flex justify-between items-center p-4 border rounded-lg shadow-md cursor-pointer ${a===r?"border-orange-500":""}`,onClick:()=>n(r),children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-5 h-5 flex justify-center items-center rounded-full border-2 ${a===r?"bg-orange-600 border-orange-600":""}`,children:a===r&&e.jsx(ue,{className:"text-white",size:12})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.addressLine1}),r.addressLine2&&e.jsx("p",{className:"text-sm text-gray-600",children:r.addressLine2}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.city,", ",r.state,", ",r.zipCode]}),e.jsx("p",{className:"text-sm text-gray-600",children:r.country})]})]}),e.jsx("div",{onClick:()=>c(r._id),children:e.jsx(Ae,{size:24,style:{color:"#cc0000"}})})]},i))})};function ze(t){return N({attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#FFF59D",cx:"24",cy:"22",r:"20"},child:[]},{tag:"path",attr:{fill:"#FBC02D",d:"M37,22c0-7.7-6.6-13.8-14.5-12.9c-6,0.7-10.8,5.5-11.4,11.5c-0.5,4.6,1.4,8.7,4.6,11.3 c1.4,1.2,2.3,2.9,2.3,4.8V37h12v-0.1c0-1.8,0.8-3.6,2.2-4.8C35.1,29.7,37,26.1,37,22z"},child:[]},{tag:"path",attr:{fill:"#FFF59D",d:"M30.6,20.2l-3-2c-0.3-0.2-0.8-0.2-1.1,0L24,19.8l-2.4-1.6c-0.3-0.2-0.8-0.2-1.1,0l-3,2 c-0.2,0.2-0.4,0.4-0.4,0.7s0,0.6,0.2,0.8l3.8,4.7V37h2V26c0-0.2-0.1-0.4-0.2-0.6l-3.3-4.1l1.5-1l2.4,1.6c0.3,0.2,0.8,0.2,1.1,0 l2.4-1.6l1.5,1l-3.3,4.1C25.1,25.6,25,25.8,25,26v11h2V26.4l3.8-4.7c0.2-0.2,0.3-0.5,0.2-0.8S30.8,20.3,30.6,20.2z"},child:[]},{tag:"circle",attr:{fill:"#5C6BC0",cx:"24",cy:"44",r:"3"},child:[]},{tag:"path",attr:{fill:"#9FA8DA",d:"M26,45h-4c-2.2,0-4-1.8-4-4v-5h12v5C30,43.2,28.2,45,26,45z"},child:[]},{tag:"g",attr:{fill:"#5C6BC0"},child:[{tag:"path",attr:{d:"M30,41l-11.6,1.6c0.3,0.7,0.9,1.4,1.6,1.8l9.4-1.3C29.8,42.5,30,41.8,30,41z"},child:[]},{tag:"polygon",attr:{points:"18,38.7 18,40.7 30,39 30,37"},child:[]}]}]})(t)}const Le=({lat1:t=13.5631658,long1:a=80.0199452,lat2:s=13.5631658,long2:n=80.0199452,onCalcDistance:c})=>{const{isLoaded:r}=pe({googleMapsApiKey:M});if(!r)return e.jsx(Q,{});const i=x=>{x&&x.rows[0].elements[0].status==="OK"?c(x.rows[0].elements[0].distance.value/1e3):console.error("DistanceMatrix request failed")},h=[{lat:t,lng:a}],p=[{lat:s,lng:n}];return e.jsx(fe,{options:{origins:p,destinations:h,travelMode:"DRIVING"},callback:i})},Me=ve("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),S=u.forwardRef(({className:t,variant:a,size:s,asChild:n=!1,...c},r)=>{const i=n?je:"button";return e.jsx(i,{className:ye(Me({variant:a,size:s,className:t})),ref:r,...c})});S.displayName="Button";const Se=({isOpen:t,onClose:a,title:s="Are you sure??",body:n,actionLabel:c,onAction:r,description:i="",onDecline:h})=>e.jsx(ae,{open:t,onOpenChange:a,children:e.jsxs(ne,{children:[e.jsxs(le,{children:[e.jsx(ie,{children:s}),i&&e.jsx(ce,{children:i})]}),e.jsx("div",{className:"modal-body",children:n}),e.jsxs(de,{children:[e.jsx(me,{asChild:!0,children:e.jsx(S,{variant:"outline",onClick:h,children:"No"})}),e.jsx(S,{className:"bg-orange-500 text-white hover:bg-orange-700",onClick:r,children:c})]})]})}),Oe=({isVisible:t,onClose:a,children:s})=>t?e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 w-80 p-2 bg-white shadow-lg rounded-md border border-gray-200 z-50",children:[s,e.jsx("button",{onClick:a,className:"mt-2 text-sm float-right text-blue-500",children:"Close"})]}):null,Pe=()=>{var V,R;const t=j(H),a=j(O),s=j(Z),n=j(G),c=P(),r=u.useMemo(()=>t.reduce((o,C)=>C.quantity*C.price+o,0),[t]),[i,h]=u.useState(""),[p,x]=u.useState(0),[b,y]=u.useState(!1),[l,d]=u.useState(!1),m=()=>{y(o=>!o)},F=()=>{y(!1)},k=o=>{console.log(o),x(o)},v=async()=>{const o=t.map(g=>({cuisine:g._id,quantity:g.quantity,price:g.quantity*g.price})),C={restaurantId:s._id,items:o,deliveryAddress:n,paymentMethod:"Cash",orderNote:i,itemTotal:r,deliveryCharge:D,gstAmount:A,discount:B,platformFee:z,totalToPay:L};try{const{data:g}=await I.post("/create-order",C);g.success&&(f.success(g.message),c(X(g.order)),c(ee()))}catch(g){console.error(g.message)}},w=()=>{d(!1)},$=()=>{if(!a){f.error("Please login first!!"),navigate("/login");return}if(!n){f.error("Please select a delivery address");return}if(p>25){f.error("Too far to deliver!!");return}d(!0)},q=s!=null&&s.gstApplicable?5:0,A=r*q/100,D=r<(s==null?void 0:s.minimumOrderForFreeDelivery)?(s==null?void 0:s.deliveryCharge)*p:0,z=5,B=0,L=r+D+z+A-B;return e.jsxs("div",{className:"max-h-screen p-4 bg-white shadow-lg rounded-lg flex flex-col",children:[(s==null?void 0:s.address)&&n&&e.jsx(Le,{lat1:(V=s==null?void 0:s.address)==null?void 0:V.latitude,long1:(R=s==null?void 0:s.address)==null?void 0:R.longitude,lat2:n==null?void 0:n.latitude,long2:n==null?void 0:n.longitude,onCalcDistance:k}),e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsx("img",{src:(s==null?void 0:s.imageUrl)||"https://assets.cntraveller.in/photos/63d8e5103d7229d4cf308f01/16:9/w_1024%2Cc_limit/Prequel-lead.jpg",alt:"Restaurant",className:"w-16 h-16 rounded-md mr-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s==null?void 0:s.address.addressLine1})]})]}),e.jsx("hr",{className:"mb-4"}),e.jsx("div",{className:"overflow-y-auto max-h-48 pr-4 flex-grow",children:e.jsx("div",{className:"space-y-4",children:t.map(o=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[(o==null?void 0:o.type)==="Veg"?e.jsx(xe,{size:16,color:"green"}):e.jsx(ge,{size:16,style:{color:"#cc0000"},className:"transform -rotate-90"}),e.jsx("span",{children:o==null?void 0:o.name})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center gap-3 border px-2 py-1",children:[e.jsx("button",{onClick:()=>c(U(o._id)),className:"text-gray-400 text-4xl",children:"-"}),e.jsx("span",{className:"mx-2 text-xl",children:o==null?void 0:o.quantity}),e.jsx("button",{onClick:()=>c(J(o._id)),className:"text-green-700 text-3xl",children:"+"})]}),e.jsx("span",{children:+(o==null?void 0:o.price)*+(o==null?void 0:o.quantity)})]})]},o._id))})}),e.jsx("hr",{className:"my-4"}),e.jsx("div",{className:"relative w-full",children:e.jsx("input",{type:"text",placeholder:"Any suggestions? We will pass it on...",className:"w-full p-4 border text-slate-500 font-medium border-gray-300 focus:outline-none focus:ring-1 focus:ring-gray-400",onChange:o=>h(o.target.value)})}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Item Total"}),e.jsx("span",{children:r})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["GST (",q,"%)"]}),e.jsxs("span",{children:["₹",A.toFixed(2)]})]}),e.jsxs("div",{className:"flex relative justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[e.jsx("span",{children:"Delivery Fee"}),e.jsx("button",{onClick:m,children:e.jsx(he,{color:"#64748B",size:15})}),e.jsx(Oe,{isVisible:b,onClose:F,children:e.jsxs("p",{children:["Enjoy free delivery on your order when you spend ₹",s==null?void 0:s.minimumOrderForFreeDelivery," or more!"]})})]}),e.jsxs("span",{children:["₹",D.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Platform fee"}),e.jsxs("span",{children:["₹",z]})]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"TO PAY"}),e.jsxs("span",{children:["₹",L.toFixed(2)]})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"border border-orange-500 rounded-md p-2",children:e.jsxs("span",{className:"flex items-center gap-1 text-slate-500 font-bold",children:[e.jsx(ze,{size:25})," split your order for faster delivery"]})}),e.jsx("button",{onClick:$,className:"w-full bg-orange-500 text-white py-2 rounded-md hover:bg-orange-600 transition-colors",children:"Order Now"})]}),e.jsx(Se,{actionLabel:"Place Order",isOpen:l,onAction:v,onClose:w,title:"Confirm Order",description:`Your total amount is ₹${L.toFixed(2)}. Are you sure you want to place order?`})]})},$e=()=>{const t=j(H);return e.jsx(te,{children:e.jsx(re,{pl:!1,children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(ke,{}),e.jsx(De,{})]}),t.length?e.jsx("div",{children:e.jsx(Pe,{})}):e.jsx(se,{to:"/",children:e.jsx("div",{className:"bg-white rounded-lg font-bold text-slate-600 p-4",children:e.jsx("h1",{className:"text-lg",children:"No Items in Cart, Add some delicious food."})})})]})})})};export{$e as default};
