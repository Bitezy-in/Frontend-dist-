import{r,j as e,u as Y,c as _,n as J,o as U,d as F,p as X,q as Z,t as ee,v as te,w as se,a as re,s as k,b as ne}from"./index-CGAI1unE.js";import{a as ae,A as oe,C as le}from"./Container-CJ2ajp-G.js";import{F as V,a as ce,b as ie}from"./index-Ckg-kY5e.js";import{c as de}from"./capitalizeWords-COkigvu9.js";import{M as me,u as A,P as fe,a as xe,b as he,m as q,L as pe}from"./proxy-ClAm-aRl.js";import{c as ue}from"./utils-F_wR6dLb.js";import{C as ge,a as je}from"./card-Dr-nCX_D.js";import"./iconBase-C-KAd6xH.js";import"./index-DXpTgGh4.js";import"./index-Bb4qSo10.js";class Ce extends r.Component{getSnapshotBeforeUpdate(a){const n=this.props.childRef.current;if(n&&a.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=n.offsetHeight||0,l.width=n.offsetWidth||0,l.top=n.offsetTop,l.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ye({children:t,isPresent:a}){const n=r.useId(),l=r.useRef(null),i=r.useRef({width:0,height:0,top:0,left:0}),{nonce:f}=r.useContext(me);return r.useInsertionEffect(()=>{const{width:c,height:s,top:g,left:j}=i.current;if(a||!l.current||!c||!s)return;l.current.dataset.motionPopId=n;const p=document.createElement("style");return f&&(p.nonce=f),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${s}px !important;
            top: ${g}px !important;
            left: ${j}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[a]),e.jsx(Ce,{isPresent:a,childRef:l,sizeRef:i,children:r.cloneElement(t,{ref:l})})}const we=({children:t,initial:a,isPresent:n,onExitComplete:l,custom:i,presenceAffectsLayout:f,mode:c})=>{const s=A(be),g=r.useId(),j=r.useCallback(x=>{s.set(x,!0);for(const w of s.values())if(!w)return;l&&l()},[s,l]),p=r.useMemo(()=>({id:g,initial:a,isPresent:n,custom:i,onExitComplete:j,register:x=>(s.set(x,!1),()=>s.delete(x))}),f?[Math.random(),j]:[n,j]);return r.useMemo(()=>{s.forEach((x,w)=>s.set(w,!1))},[n]),r.useEffect(()=>{!n&&!s.size&&l&&l()},[n]),c==="popLayout"&&(t=e.jsx(ye,{isPresent:n,children:t})),e.jsx(fe.Provider,{value:p,children:t})};function be(){return new Map}const z=t=>t.key||"";function $(t){const a=[];return r.Children.forEach(t,n=>{r.isValidElement(n)&&a.push(n)}),a}const ve=({children:t,exitBeforeEnter:a,custom:n,initial:l=!0,onExitComplete:i,presenceAffectsLayout:f=!0,mode:c="sync"})=>{const s=r.useMemo(()=>$(t),[t]),g=s.map(z),j=r.useRef(!0),p=r.useRef(s),x=A(()=>new Map),[w,E]=r.useState(s),[y,S]=r.useState(s);xe(()=>{j.current=!1,p.current=s;for(let u=0;u<y.length;u++){const h=z(y[u]);g.includes(h)?x.delete(h):x.get(h)!==!0&&x.set(h,!1)}},[y,g.length,g.join("-")]);const b=[];if(s!==w){let u=[...s];for(let h=0;h<y.length;h++){const C=y[h],R=z(C);g.includes(R)||(u.splice(h,0,C),b.push(C))}c==="wait"&&b.length&&(u=b),S($(u)),E(s);return}const{forceRender:N}=r.useContext(he);return e.jsx(e.Fragment,{children:y.map(u=>{const h=z(u),C=s===y||g.includes(h),R=()=>{if(x.has(h))x.set(h,!0);else return;let I=!0;x.forEach(M=>{M||(I=!1)}),I&&(N==null||N(),S(p.current),i&&i())};return e.jsx(we,{isPresent:C,initial:!j.current||l?void 0:!1,custom:C?void 0:n,presenceAffectsLayout:f,mode:c,onExitComplete:C?void 0:R,children:u},h)})})},Ne="/assets/sorry-we-are-closed-xN2Ht5T6.jpg",Re=({restaurant:t,open:a})=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 pb-6",children:[e.jsx(ae,{src:(t==null?void 0:t.imageUrl)||"https://assets.cntraveller.in/photos/63d8e5103d7229d4cf308f01/16:9/w_1024%2Cc_limit/Prequel-lead.jpg",size:"8",grey:!a}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"font-bold text-xl md:text-2xl",children:t==null?void 0:t.name}),e.jsx("div",{className:"font-semibold text-sm md:text-lg text-slate-600",children:de((t==null?void 0:t.categories.slice(0,3).join(","))||"Indian, Italian")}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(V,{size:18,color:"green"}),e.jsx("span",{className:"ml-1 text-green-600 font-semibold",children:(t==null?void 0:t.rating)||4.2}),e.jsxs("span",{className:"ml-2 text-gray-600 text-sm",children:["(",(t==null?void 0:t.peopleRated)||28,")"]})]})]})]}),!a&&e.jsx("div",{children:e.jsx("img",{src:Ne,alt:"closed",height:300,width:300,className:"rounded-lg"})})]}),Se=({cuisine:t,isAvailable:a,restaurant:n,open:l})=>{const i=Y(),f=_(J),c=_(U),s=c.find(x=>x._id===t._id),[g,j]=r.useState(!1);F(),c.reduce((x,w)=>x+w.quantity,0);const p=()=>{if(a){if(f&&f._id!==t.restaurantId){alert("You can only order from one restaurant at a time.");return}f||(console.log(n),i(ee(n))),i(te(t)),j(!0)}};return r.useEffect(()=>{c.length>0&&j(!0)},[c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center border-b-2 py-4 border-slate-200 p-4 shadow-md bg-white rounded-lg",children:[e.jsxs("div",{className:"flex-1 pr-6",children:[(t==null?void 0:t.type)==="Veg"?e.jsx(ce,{size:24,color:"green"}):e.jsx(ie,{size:24,style:{color:"#cc0000"},className:"transform -rotate-90"}),e.jsx("h2",{className:"mt-1 text-lg font-semibold text-gray-800",children:t==null?void 0:t.name}),e.jsxs("p",{className:"text-gray-600 font-semibold",children:["â‚¹",t==null?void 0:t.price]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(V,{size:18,color:"green"}),e.jsx("span",{className:"ml-1 text-green-600 font-semibold",children:(t==null?void 0:t.rating)||4.2}),e.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"(29)"})]}),e.jsx("p",{className:"text-gray-500 mt-1",children:t==null?void 0:t.description})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-36 w-36",children:e.jsx("img",{src:!(t!=null&&t.imageUrl)||(t==null?void 0:t.imageUrl)==="https://res.cloudinary.com/didsernha/image/upload/v1728458954/cuisine images/db5afc54-e82f-4a2b-b819-6fcfad778812.jpg"?"https://img.freepik.com/premium-photo/ai-generated-photo-selection-healthy-diet-nutritionist-food-illustration_999340-2284.jpg":t.imageUrl,alt:t==null?void 0:t.name,className:`w-full h-full object-cover rounded-lg ${a&&l?"":"filter grayscale"}`})}),s?a&&e.jsxs("div",{className:"flex items-center justify-between border px-2 py-1",children:[e.jsx("button",{onClick:()=>i(X(s._id)),className:"text-gray-400 text-4xl",children:"-"}),e.jsx("span",{className:"mx-2 text-xl",children:s==null?void 0:s.quantity}),e.jsx("button",{onClick:()=>i(Z(s._id)),className:"text-green-700 text-3xl",children:"+"})]}):e.jsx("button",{disabled:!a||!l,onClick:p,className:`w-full p-1 rounded-lg text-center text-white cursor-pointer ${!a||!l?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:"Add"})]})]})})},B=r.forwardRef(({className:t,type:a,...n},l)=>e.jsx("input",{type:a,className:ue("flex h-10 w-full rounded-md border border-input",t),ref:l,...n}));B.displayName="Input";const O=({label:t,checked:a,onChange:n,disabled:l,color:i})=>{const c=a?{green:"bg-green-800",red:"bg-red-700"}[i]:"bg-gray-500";return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer ${c} ${l?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!l&&n(!a),children:e.jsx(q.div,{className:"bg-white w-4 h-4 rounded-full shadow-md",animate:{x:a?24:0}})}),e.jsx(pe,{className:"cursor-pointer",onClick:()=>!l&&n(!a),children:t})]})},Ee=({value:t,onChange:a})=>e.jsx("div",{className:"relative w-full",children:e.jsx(B,{type:"text",placeholder:"Search cuisine...",value:t,onChange:n=>a(n.target.value),className:"w-full border rounded-lg px-2 py-5 focus:outline-none focus:ring-2 focus:ring-orange-500"})}),Ie=({categories:t,value:a,onChange:n,disabled:l})=>{const[i,f]=r.useState(!1),c=r.useRef(null);return r.useEffect(()=>{if(i){const s=g=>{c.current&&!c.current.contains(g.target)&&f(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}}},[i]),e.jsxs("div",{ref:c,className:"relative w-full",children:[e.jsx("button",{className:"w-full px-4 py-2 text-left bg-white rounded-md flex justify-between items-center",onClick:()=>f(!i),children:e.jsx("span",{children:a||"All Categories"})}),i&&e.jsxs("div",{className:"absolute max-h-[15rem] overflow-auto z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg",children:[e.jsx("button",{className:"w-full px-4 py-1 text-left hover:bg-gray-100",onClick:()=>{n(""),f(!1)},children:"All Categories"}),t.map(s=>e.jsx("button",{className:"w-full px-4 py-1 text-left hover:bg-gray-100",onClick:()=>{n(s.toLowerCase()),f(!1)},children:s},s))]})]})},Ve=()=>{const a=se().id,[n,l]=r.useState(null),[i,f]=r.useState([]),[c,s]=r.useState([]),[g,j]=r.useState([]),[p,x]=r.useState(null),[w,E]=r.useState(!1),[y,S]=r.useState(!1),[b,N]=r.useState(!1),[u,h]=r.useState(""),[C,R]=r.useState(""),I=_(U),M=F(),P=I.reduce((o,d)=>o+d.quantity,0),D=()=>{M("/cart")};r.useEffect(()=>{K(),k.emit("joinRestaurant",a),k.on("restaurantStatusUpdated",({restaurantId:d,isOpen:v})=>{x(v)});const o=({cuisineId:d,isAvailable:v})=>{f(L=>L.map(m=>m.cuisine._id===d?{...m,cuisine:{...m.cuisine,isAvailable:v}}:m))};return k.on("cuisineUpdated",o),()=>{k.off("cuisineUpdated")}},[]);const T=()=>{S(!y),N(!1),R("")},Q=()=>{S(!1),N(!b),R("")},H=o=>{R(o),N(!1),S(!1),h("")};r.useEffect(()=>{G()},[y,b,u,C,i]);const K=async()=>{var o,d,v,L;try{E(!0);const{data:m}=await re.get(`/restaurants/${a}`);l(m.restaurant),f(((o=m==null?void 0:m.restaurant)==null?void 0:o.cuisines)||[]),s(((d=m==null?void 0:m.restaurant)==null?void 0:d.cuisines)||[]),j(W(((v=m==null?void 0:m.restaurant)==null?void 0:v.cuisines)||[])),x((L=m==null?void 0:m.restaurant)==null?void 0:L.isOpen)}catch(m){console.error(m.message)}finally{E(!1)}},W=o=>{const d=new Set(o.map(v=>v.cuisine.category));return Array.from(d)},G=()=>{let o=[...i];C?o=o.filter(d=>d.cuisine.name.toLowerCase().includes(C.toLowerCase())||d.cuisine.description.toLowerCase().includes(C.toLowerCase())):(y&&(o=o.filter(d=>d.cuisine.type.toLowerCase()==="veg")),b&&(o=o.filter(d=>d.cuisine.type.toLowerCase()==="non-veg")),u&&(o=o.filter(d=>d.cuisine.category.toLowerCase()===u.toLowerCase()))),s(o)};return e.jsx(e.Fragment,{children:w?e.jsx(ne,{}):e.jsx(oe,{children:e.jsx(le,{children:e.jsxs("div",{className:`md:px-16 relative ${P>0?"pb-16":""}`,children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(Re,{restaurant:n,open:p}),e.jsx(ge,{className:"rounded-lg",children:e.jsxs(je,{className:"flex flex-col gap-6 !p-0",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Veg"}),e.jsx(O,{label:"",onChange:T,checked:y,color:"green"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Non-Veg"}),e.jsx(O,{label:"",onChange:Q,checked:b,color:"red"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ie,{categories:g,value:u,onChange:o=>h(o)}),e.jsx(Ee,{value:C,onChange:o=>H(o)})]})]})}),e.jsx(ve,{children:(c==null?void 0:c.length)>0?e.jsx("div",{className:"flex flex-col gap-6",children:c.map(o=>{var d;return e.jsx(Se,{cuisine:o==null?void 0:o.cuisine,isAvailable:(d=o==null?void 0:o.cuisine)==null?void 0:d.isAvailable,open:p,restaurant:n},o==null?void 0:o._id)})}):e.jsx(q.div,{className:"text-center text-gray-500",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:"No cuisines available"})})]}),P>0&&e.jsx("div",{className:"mb-14 md:mb-0 fixed bottom-0 left-0 right-0 mt-6 bg-green-600 text-white py-4 px-8 flex justify-between items-center",children:e.jsxs("div",{className:"w-full max-w-[calc(100%-2rem)] mx-auto flex justify-between items-center",children:[e.jsxs("span",{className:"font-semibold",children:[P," item(s) in cart"]}),e.jsx("button",{onClick:D,className:"bg-white text-green-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100",children:"Show Cart"})]})})]})})})})};export{Ve as default};
